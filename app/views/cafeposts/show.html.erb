<h2><%= @cafepost.name %></h2>

<table class='table table-boarderd'>
  <tr>
    <td>投稿者</td>
    <td><%= link_to @cafepost.user.name, user_path(@cafepost.user) %></td>
  </tr>
  <tr>
    <td>投稿日</td>
    <td><%= @cafepost.created_at.strftime('%Y/%m/%d') %></td>
  </tr>
  <tr>
    <td>カフェ名</td>
    <td><%= @cafepost.name %></td>
  </tr>
  <tr>
    <td>都道府県</td>
    <td><%= @cafepost.prefecture_i18n %></td>
  </tr>
  <tr>
    <td>住所</td>
    <td><%= @cafepost.address %></td>
  </tr>
  <tr>
    <td>口コミ</td>
    <td><%= @cafepost.content %></td>
  </tr>
  <tr>
    <td>画像</td>
    <td><%= image_tag @cafepost.image.url if @cafepost.image? %></td>
  </tr>
  <tr>
    <td>地図</td>
    <td>
      <script type="text/javascript">
        function initMap() {
        <!-- #latitude,longitudeから位置を特定 -->
          var test ={lat: <%= @cafepost.latitude %>, lng: <%= @cafepost.longitude %>};
          var map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 15, 
                    center: test
                    });
          var transitLayer = new google.maps.TransitLayer();
          transitLayer.setMap(map);
      
          var contentString = '住所：<%= @cafepost.address %>';
          var infowindow = new google.maps.InfoWindow({
            content: contentString
          });
      
       <!-- #Map上の指定した位置にピンを挿して表示する -->
          var marker = new google.maps.Marker({
                        position:test,
                        map: map,
                        title: contentString
                       });
      
           marker.addListener('click', function() {
             infowindow.open(map, marker);
           });
        }
      </script>
      <script async defer
                src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap">
      </script>
            
      <style type="text/css">
        #map { height: 200px;
               width: 70%;}
      </style>
        
        <!-- #mapの表示 -->
        <div id="map"></div>
    </td>
  </tr>
</table>

<div class='btn-group'>
  <%= render "favorites/favorite_button", cafepost: @cafepost %>
  <% if current_user == @cafepost.user %>
    <%= link_to 'Edit', edit_cafepost_path(@cafepost), class: 'btn btn btn-outline-dark btn-sm ml-1' %>
    <%= link_to "Delete", @cafepost, method: :delete, data: { confirm: "You sure?" }, class: 'btn btn btn-outline-dark btn-sm ml-1' %>
  <% end %>
</div>